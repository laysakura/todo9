* kossy-memo-sample
  ブラウザで動くTODOリスト．

** 使い方
*** MySQL 5.1 に日本語全文検索機能を追加
    参考: http://d.conma.me/entry/20100913/1284347235
   #+BEGIN_SRC sh
# mysqld は起動させておく
sudo apt-get install mecab mecab-naist-jdic libmecab-dev
wget http://sourceforge.net/projects/mysqlftppc/files/latest/download?source=files -O mysqlftppc-mecab-1.6.1.tar.gz
tar xvf mysqlftppc-mecab-1.6.1.tar.gz
cd mysqlftppc-mecab-1.6.1
./configure --with-mysql-config=/path/to/mysql_config --with-mecab_config=/path/to/mecab-config
make && sudo make install
mysql -uroot -e "install plugin mecab soname 'libftmecab.so';"
   #+END_SRC

*** Webサービス立ち上げ
   #+BEGIN_SRC sh
$ carton install
$ vi lib/KossyMemoSample/Config.pm  # MySQL接続パラメータを設定
$ # mysql 起動
$ mysql -u [ユーザ名] [DB名] < db/init.sql
$ carton exec -- plackup -r -E production app.psgi
$ firefox localhost:5000
   #+END_SRC


* データセット
  http://cgi.members.interq.or.jp/mercury/p37/name/index.cgi?q=%E3%81%A8&gen=1
  - 男性名 ('あ-と'まで)
  - 女性名 ('な-わ'まで)

* fixme
  *コードにも埋め込んでる*
  - edit.txでformタグが2つなのが超キモい
  - edit.txで，POSTでdeleteなinputを飛ばしてるのがキモい
  - SQLインジェクションし放題
  - 1件も検索結果が帰ってこないときにserver error

* TODOs
  - [X] API作成
    - [X] テーブルを古山と相談したものに
    - [X] Perl API (検索結果の「何ページ目」「何個ずつ」ってのもユーザに渡してもらう)
      #+BEGIN_SRC json
{
    "all_count": 780,
    # "page_count": 20,
    # "page": 3,
    "results": { "id": 122, "content": "ほげほげ", ...}
}
      #+END_SRC
    - [X] ドキュメント業
  - [ ] 自分のtodo9をfuruyamaプラグインを使う形に
  - bootstrapの btn, btn-primaryみたいなclassをもっと見出してUIをまともに
  - [ ] 沢山のTODOを表示するための工夫
    - [ ] / では，適当な数を表示し，プラスで「全部表示」みたいにする
    - [ ] /search_result や /todos では，Googleみたいに20件ずつ表示みたいな
    - [ ] とにかくどんな場合であろうと，perlのデータ構造に超多い件数のレコードが，ってことはないように
      - [ ] リモートのDBサーバから転送する場合のコストを考える
  - ページのタイトルやら日本語やらをもう少しまともにする
  - [-] 本気のbig dataつくる
    - [X] まず件数を見積もる
    - [ ] tunaでmysql5.1 + fulltext使えるように
    - [ ] サイズどのくらいだと素早く検索終わるか検証
    - [ ] LIKE % と比べてみる
    - [ ] data source の string変えるだけでtunaにつなげるように
  - 一致部分を赤くしたり
    - 結果数件に対し LIKE '%hoge%' すりゃいい
  - <form> 排してjQueryのXHRでぬるぬるPOST
  - 古山案件
    - ストレージエンジン，初期DB設定の自動化
    - Fulltextモジュールの作成
